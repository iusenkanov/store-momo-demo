{"remainingRequest":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/thread-loader/dist/cjs.js!/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/babel-loader/lib/index.js!/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/ts-loader/index.js??ref--14-3!/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/src/store/index.ts","dependencies":[{"path":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/src/store/index.ts","mtime":1743484457794},{"path":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/babel.config.js","mtime":1743484457788},{"path":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1743485460826},{"path":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1743485460826},{"path":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/babel-loader/lib/index.js","mtime":1743485462509},{"path":"/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/node_modules/ts-loader/index.js","mtime":1743485460995}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5yZWR1Y2UuanMiOwppbXBvcnQgeyBjcmVhdGVTdG9yZSB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgQXBpU2VydmljZSBmcm9tICdAL3NlcnZpY2VzL2FwaS5zZXJ2aWNlJzsKY29uc3QgY2FydCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhcnQnKSB8fCAne30nKTsKZnVuY3Rpb24gZ2V0SWRTdHJpbmcob2JqKSB7CiAgcmV0dXJuICdfJyArIG9iai5pZC50b1N0cmluZygpOwp9CmNvbnN0IHN0b3JlID0gY3JlYXRlU3RvcmUoewogIHN0YXRlOiB7CiAgICBjYXJ0LAogICAgYXV0aDogewogICAgICBjaGVja2VkOiBmYWxzZSwKICAgICAgaXNMb2dnZWRJbjogZmFsc2UKICAgIH0KICB9LAogIGdldHRlcnM6IHsKICAgIGNhcnRBc0FycmF5OiBzdGF0ZSA9PiB7CiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHN0YXRlLmNhcnQpOwogICAgfSwKICAgIG51bWJlck9mSXRlbXNJbkNhcnQ6IHN0YXRlID0+IHsKICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoc3RhdGUuY2FydCkucmVkdWNlKChhY2MsIGl0ZW0pID0+IHsKICAgICAgICByZXR1cm4gYWNjICsgaXRlbS5xdWFudGl0eTsKICAgICAgfSwgMCk7CiAgICB9LAogICAgY2FydFRvdGFsOiBzdGF0ZSA9PiB7CiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHN0YXRlLmNhcnQpLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiB7CiAgICAgICAgcmV0dXJuIGFjYyArIGl0ZW0ucXVhbnRpdHkgKiBpdGVtLnByb2R1Y3QucHJpY2U7CiAgICAgIH0sIDApOwogICAgfSwKICAgIHVzZXJGdWxsbmFtZTogc3RhdGUgPT4gewogICAgICBpZiAoIXN0YXRlLmF1dGgudXNlcikgcmV0dXJuICcnOwogICAgICByZXR1cm4gc3RhdGUuYXV0aC51c2VyLmZpcnN0X25hbWUgKyAnICcgKyBzdGF0ZS5hdXRoLnVzZXIubGFzdF9uYW1lOwogICAgfQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBhZGRUb0NhcnQoc3RhdGUsIHByb2R1Y3QpIHsKICAgICAgaWYgKHN0YXRlLmNhcnRbZ2V0SWRTdHJpbmcocHJvZHVjdCldKSB7CiAgICAgICAgc3RhdGUuY2FydFtnZXRJZFN0cmluZyhwcm9kdWN0KV0ucXVhbnRpdHkrKzsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdGF0ZS5jYXJ0W2dldElkU3RyaW5nKHByb2R1Y3QpXSA9IHsKICAgICAgICAgIHByb2R1Y3QsCiAgICAgICAgICBxdWFudGl0eTogMQogICAgICAgIH07CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVGcm9tQ2FydChzdGF0ZSwgcHJvZHVjdCkgewogICAgICBkZWxldGUgc3RhdGUuY2FydFtnZXRJZFN0cmluZyhwcm9kdWN0KV07CiAgICB9LAogICAgc2V0QXV0aENoZWNrZWQoc3RhdGUsIHZhbHVlKSB7CiAgICAgIHN0YXRlLmF1dGguY2hlY2tlZCA9IHZhbHVlOwogICAgfSwKICAgIHNldEF1dGhMb2dnZWRJbihzdGF0ZSwgdmFsdWUpIHsKICAgICAgc3RhdGUuYXV0aC5pc0xvZ2dlZEluID0gdmFsdWU7CiAgICB9LAogICAgc2V0QXV0aFVzZXIoc3RhdGUsIHVzZXIpIHsKICAgICAgc3RhdGUuYXV0aC51c2VyID0gdXNlcjsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIGFzeW5jIGNoZWNrQXV0aCh7CiAgICAgIGNvbW1pdAogICAgfSkgewogICAgICBjb25zdCB1c2VyID0gYXdhaXQgQXBpU2VydmljZS5nZXQoJy9hdXRoL3dob2FtaS8nKS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSByZXR1cm4gbnVsbDsKICAgICAgfSk7CiAgICAgIGNvbW1pdCgnc2V0QXV0aENoZWNrZWQnLCB0cnVlKTsKICAgICAgY29tbWl0KCdzZXRBdXRoTG9nZ2VkSW4nLCAhIXVzZXIpOwogICAgICBjb21taXQoJ3NldEF1dGhVc2VyJywgdXNlcik7CiAgICB9LAogICAgbG9naW4oewogICAgICBjb21taXQKICAgIH0sIGNyZWRlbnRpYWxzKSB7CiAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnBvc3QoJy9hdXRoL2xvZ2luLycsIGNyZWRlbnRpYWxzKS50aGVuKHVzZXIgPT4gewogICAgICAgIGNvbW1pdCgnc2V0QXV0aExvZ2dlZEluJywgdHJ1ZSk7CiAgICAgICAgY29tbWl0KCdzZXRBdXRoVXNlcicsIHVzZXIpOwogICAgICAgIHJldHVybiB1c2VyOwogICAgICB9KTsKICAgIH0sCiAgICBsb2dvdXQoewogICAgICBjb21taXQKICAgIH0pIHsKICAgICAgcmV0dXJuIEFwaVNlcnZpY2UucG9zdCgnL2F1dGgvbG9nb3V0LycpLnRoZW4oKCkgPT4gewogICAgICAgIGNvbW1pdCgnc2V0QXV0aExvZ2dlZEluJywgZmFsc2UpOwogICAgICAgIGNvbW1pdCgnc2V0QXV0aFVzZXInLCBudWxsKTsKICAgICAgICBBcGlTZXJ2aWNlLmNzcmZfdG9rZW4gPSAnJzsKICAgICAgfSk7CiAgICB9LAogICAgY2hhbmdlUGFzc3dvcmQoewogICAgICBjb21taXQKICAgIH0sIGNyZWRlbnRpYWxzKSB7CiAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnBvc3QoJy9hdXRoL2NoYW5nZS1wYXNzd29yZC8nLCBjcmVkZW50aWFscykudGhlbihkYXRhID0+IHsKICAgICAgICBjb21taXQoJ3NldEF1dGhMb2dnZWRJbicsIGZhbHNlKTsKICAgICAgICBjb21taXQoJ3NldEF1dGhVc2VyJywgbnVsbCk7CiAgICAgICAgQXBpU2VydmljZS5jc3JmX3Rva2VuID0gJyc7CiAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgIH0pOwogICAgfQogIH0sCiAgbW9kdWxlczoge30KfSk7CnN0b3JlLmRpc3BhdGNoKCdjaGVja0F1dGgnKTsKc3RvcmUuc3Vic2NyaWJlKChtdXRhdGlvbiwgc3RhdGUpID0+IHsKICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FydCcsIEpTT04uc3RyaW5naWZ5KHN0YXRlLmNhcnQpKTsKfSk7CmV4cG9ydCBkZWZhdWx0IHN0b3JlOw=="},{"version":3,"names":["createStore","ApiService","cart","JSON","parse","localStorage","getItem","getIdString","obj","id","toString","store","state","auth","checked","isLoggedIn","getters","cartAsArray","Object","values","numberOfItemsInCart","reduce","acc","item","quantity","cartTotal","product","price","userFullname","user","first_name","last_name","mutations","addToCart","removeFromCart","setAuthChecked","value","setAuthLoggedIn","setAuthUser","actions","checkAuth","commit","get","catch","error","response","status","login","credentials","post","then","logout","csrf_token","changePassword","data","modules","dispatch","subscribe","mutation","setItem","stringify"],"sources":["/Users/iskenderusenkanov/Kubernetes/momo-store-demo/frontend/src/store/index.ts"],"sourcesContent":["import { createStore, Store } from 'vuex'\nimport { AxiosError } from 'axios';\n\nimport { Cart } from '@/typings';\n\nimport ApiService from '@/services/api.service';\nimport ProductModel from '@/models/product.model';\n\nconst cart: Cart = JSON.parse(localStorage.getItem('cart') || '{}');\n\nfunction getIdString<T extends {id: number}>(obj: T): string {\n  return '_' + obj.id.toString();\n}\n\ntype State = {\n  cart: Cart;\n  auth: {\n    checked: boolean,\n    isLoggedIn: boolean,\n    user?: {\n      id: number,\n      first_name: string,\n      last_name: string,\n      email: string,\n    }\n  }\n}\n\nconst store: Store<State> = createStore({\n  state: {\n    cart,\n    auth: {\n      checked: false,\n      isLoggedIn: false, \n    }\n  } as State,\n  getters: {\n    cartAsArray: state => {\n      return Object.values(state.cart);\n    },\n    numberOfItemsInCart: state => {\n      return Object.values(state.cart).reduce((acc, item) => {\n        return acc + item.quantity;\n      }, 0);\n    },\n    cartTotal: state => {\n      return Object.values(state.cart).reduce((acc, item) => {\n        return acc + item.quantity * item.product.price;\n      }, 0);\n    },\n    userFullname: state => {\n      if(!state.auth.user) return '';\n      return state.auth.user.first_name + ' ' + state.auth.user.last_name;\n    }\n  },\n  mutations: {\n    addToCart(state, product: ProductModel) {\n      \n      if(state.cart[getIdString(product)]) {\n        state.cart[getIdString(product)].quantity++;\n      } else {\n        state.cart[getIdString(product)] = {\n          product,\n          quantity: 1,\n        };\n      }\n\n    },\n    removeFromCart(state, product: ProductModel) {\n      delete state.cart[getIdString(product)];\n    },\n    setAuthChecked(state, value: boolean) {\n      state.auth.checked = value;\n    },\n    setAuthLoggedIn(state, value: boolean) {\n      state.auth.isLoggedIn = value;\n    },\n    setAuthUser(state, user: any) {\n      state.auth.user = user;\n    }\n  },\n  actions: {\n    async checkAuth({ commit }) {\n      \n      const user = await ApiService.get('/auth/whoami/').catch((error: AxiosError) => {\n        if(error.response && error.response.status === 403) return null\n      });\n\n      commit('setAuthChecked', true);\n      commit('setAuthLoggedIn', !!user);\n      commit('setAuthUser', user);\n\n    },\n    login({ commit }, credentials: {email: string, password: string}) {\n      return ApiService.post('/auth/login/', credentials).then(user => {\n        commit('setAuthLoggedIn', true);\n        commit('setAuthUser', user);\n        return user;\n      });\n    },\n    logout({ commit }) {\n      return ApiService.post('/auth/logout/').then(() => {\n        commit('setAuthLoggedIn', false);\n        commit('setAuthUser', null);\n        ApiService.csrf_token = '';\n      });\n    },\n    changePassword({ commit }, credentials: {old_password: string, new_password: string}) {\n      return ApiService.post('/auth/change-password/', credentials).then((data: any) => { \n        commit('setAuthLoggedIn', false);\n        commit('setAuthUser', null);\n        ApiService.csrf_token = '';\n        return data;\n      });\n    },\n  },\n  modules: {\n  }\n});\n\nstore.dispatch('checkAuth');\n\nstore.subscribe((mutation, state) => {\n  localStorage.setItem('cart', JSON.stringify(state.cart));\n});\n\nexport default store;\n"],"mappings":"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","ignoreList":[]}]}